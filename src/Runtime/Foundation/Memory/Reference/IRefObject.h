//***********************************************************
//! @file
//! @brief		参照カウントオブジェクト・インターフェース
//! @author		Gajumaru
//***********************************************************
#pragma once
#include <Runtime/Foundation/Base/Fwd.h>

namespace ob {

    //@―---------------------------------------------------------------------------
    //! @brief      参照カウントオブジェクト・インターフェース
    //! 
    //! @details    参照カウントによるメモリ管理をする場合は RefObject クラスを継承してくだ
    //!             さい。
    //!             一般的には RefObject 用のスマートポインタである Ref を使用して参
    //!             照を管理します。
    //@―---------------------------------------------------------------------------
    class IRefObject {
        template<class T>
        friend class Ref;
        friend class RefObjectHelper;
    public:

        //===============================================================
        // コンストラクタ / デストラクタ
        //===============================================================


        //@―---------------------------------------------------------------------------
        //! @brief  デストラクタ
        //@―---------------------------------------------------------------------------
        virtual ~IRefObject() {}


    protected:

        //@―---------------------------------------------------------------------------
        //! @brief  参照カウントが0になったときにデストラクタを呼ぶようにする
        //@―---------------------------------------------------------------------------
        virtual void EnableDestruct()noexcept = 0;


        //@―---------------------------------------------------------------------------
        //! @brief  参照カウントの取得
        //@―---------------------------------------------------------------------------
        virtual s32 GetReferenceCount()const noexcept = 0;


        //@―---------------------------------------------------------------------------
        //! @brief  参照の追加
        //@―---------------------------------------------------------------------------
        virtual s32 Retain() = 0;


        //@―---------------------------------------------------------------------------
        //! @brief  参照の解放
        //@―---------------------------------------------------------------------------
        virtual s32 Release() = 0;

    };

}// namespcae ob