コーディン規約
=================

C++のバージョン
---------------
C++17を最低要件として記述してください。noexcept等をマクロで定義しなおす必要はありませんが、C++20やC++23で導入される機能やコンパイラ固有の機能ついてはマクロを使用してコンパイラごとの機能を選択して使用する必要があります。(例：FORCEINLINE) 
```c++
class Hoge{
public:

  FOREINLINE void Func()noexcept;
  
  // コンパイラ固有の機能を使用することはできません
  // C++17で導入済みの機能はマクロを使用して置き換えません
  // __forceinline__ void Func() NOEXCEPT;
  
};
```
最新の言語バージョンで廃止されている機能や非推奨機能は避けるようにしてください。
```c++
void Func(){
  // 非推奨機能や削除される機能の使用は避けてください
  // std::auto_ptr<Hoge> aptr;
}
```

ディレクトリ構造
------------------
|フォルダ名|用途|
|-|-|
|Public|上位モジュールから使用されるクラスのヘッダ|
|Protected|派生モジュールで実装するインターフェイス(非推奨)|
|Private|cppファイルとモジュール内だけで使用するクラスのヘッダ|
|Test|モジュールのテスト実装|
|Misc|natvisやドキュメントなど|

上記フォルダをモジュールのルートフォルダに配置し各フォルダの内部にインクルードパスとして使用するフォルダを作成してください。例えばCoreモジュールのファイルは以下のパスに保存します。
* ```Source/Framework/Core/Private/Framework/Core/Graphics/Color.cpp```
* ```Source/Framework/Core/Public/Framework/Core/Graphics/Color.h```

ディレクトリ名は単数形での表記を基準とします。ただし妥当な理由があれば複数形のディレクトリ名でも構いません。例えばGraphicsはGraphicのコードの集合ではなく**Graphics**に関するコードの集合です。

ファイルの命名規則
------------------
* ファイル名はクラス名と一致するようにしてください。
* クラスが複数ある場合やクラスがないファイルはクラス名と同じ命名規則でわかりやすい名前を付けてください。
* 拡張子は```.cpp```/```.h```を使用してください。

ヘッダファイル
-------------
* ヘッダファイルは自己完結で単体でコンパイルできなくてはいけません。
* インクルードガードには```#pragma once```を使用してください。
* ヘッダの依存を下げるためにPimplイディオムやインターフェイスによる実装を検討してください。

インライン関数
--------------
* 関数の定義が短い場合はインライン関数の使用してください。
  * ループ文やswitch文、再帰関数がある場合はインライン化する必要はありません。
* ヘッダの依存が増える場合は関数ん定義が短い場合でもインライン関数を使用しないでください。
* インライン関数の定義はファイルの下部にまとめて書いてください。
  * ゲッターやセッターのような非常に短い関数はクラス宣言内に定義を記述しても構いません。
* 初期実装段階ではインライン化せずcppに実装することを推奨します。
    * 設計が固まった段階でインライン化し、頻繁にヘッダが書き変わらないようにしてください。

名前空間
--------
* 名前空間はすべて小文字にし、一単語で記述するようにしてください。
* 全てのエンジンコードは```namespace ob```内に記述してください。
* モジュールごとに名前空間を分けるようにしてください。
* ネストした名前空間は```namespace ob::graphic{}```のような表記します。

構造体
------
* 全てのメンバ変数がpublicの場合のみstructを使用できます。
* メンバ変数には接頭辞をつけません。

クラス
-----
* RAII（Resource Acquisition Is Initialization）を意識し、```startup()```や```shutdown()```などの関数を使用しないでください。
* ```initialize()```は初期化/再初期化の機能として実装してください。遅延初期化のために実装してはいけません。

クラスの構造
------------
クラス宣言は
1. タイプ宣言
2. ファクトリ
3. インナークラス宣言
4. メンバ関数
5. メンバ変数

の順で記述します。  
構造体は先頭にメンバ変数を置く場合もあります。

命名規則
--------

|種別|命名規則|
|:--|---|
|フォルダ名|SampleID|
|ファイル名|SampleID.cpp|
|クラス名|SampleID|
|構造体名|SampleID|
|メンバ関数|sampleID()|
|メンバStatic関数|SampleID()|
|メンバ変数|m_sampleID|
|構造体変数|sampleID|
|ローカル変数|sampleID|
|static変数|s_sampleID|
|列挙型|Enum::SampleID|
|マクロ|SAMPLE_ID|
|マクロ(内部)|_internal_SAMPLE_ID|

内部で使用する機能は```namespace *::internal```に実装してください
```c++
#define _internal_ADD(a,b) (a+b)
#define ADD(a,b) _internal_ADD(a,b)
enum class Type{
  Open,
  Close
}
struct Point{
  float x;
  float y;
}
class Line{
public:
  static Line Create();
public:
  Line():m_type(Type::Open){}
  void Set(const Point& start,const Point& end){
    m_start=start;
    m_end=end;
  }
private:
  Type  m_type;
  Point m_start;
  Point m_end;
}
```

コメント
--------
コメントは主に```//```を使用し、```/* */```は広範囲のコードを一時的に無効化するために使用してください。一般的なコメントに```/* */```を使用するとそのコメントを含む範囲で```/* */```が使えなくなるので、長期的に残すコメントは```//```を使うようにしてください。

ドキュメント・コメント
---------------------
* Doxygenでドキュメントを自動生成するために、ヘッダには関数やクラスのドキュメントコメントを書くようにしてください。
* インライン関数の範囲は```@cond```を使用してドキュメントの二重定義を防ぎます。
```c++
//@―---------------------------------------------------------------------------
//! @brief      説明
//!
//! @details    詳細
//! @param arg  引数説明
//@―---------------------------------------------------------------------------
void hoge(int arg);
```

